


ARM Macro Assembler    Page 1 


    1 00000000         
    2 00000000                 AREA             PROGRAM, CODE, READONLY
    3 00000000         
    4 00000000                 EXPORT           bcdadd
    5 00000000                 ENTRY
    6 00000000         
    7 00000000         bcdadd
    8 00000000         
    9 00000000 F240 2036       MOV              r0, #0x00000236
   10 00000004 F240 3187       MOV              r1, #0x00000387
   11 00000008 F000 F801       BL               add
   12 0000000C         
   13 0000000C         
   14 0000000C E7FE    stop    B                stop
   15 0000000E         
   16 0000000E         ;assumes well formatted BCDs (i.e. no nibble over 9)
   17 0000000E         add
   18 0000000E F04F 0400       MOV              r4, #0      ;r4 will contain th
                                                            e result
   19 00000012 F04F 0300       MOV              r3, #0      ;r2 and r3 are for 
                                                            additions (r3 conta
                                                            ins result)
   20 00000016 F04F 0200       MOV              r2, #0
   21 0000001A         
   22 0000001A         ;values used for special purposes (shifted left after ev
                       ery nibble addition)
   23 0000001A F04F 050F       MOV              r5, #0x0000000f ;used as mask t
                                                            o extract nibble
   24 0000001E F04F 0609       MOV              r6, #0x00000009 ;used to determ
                                                            ine if sum greater 
                                                            than 9
   25 00000022 F04F 0706       MOV              r7, #0x00000006 ;used to add 6 
                                                            to a sum if greater
                                                             than 9
   26 00000026         
   27 00000026         next
   28 00000026 EA00 0205       AND              r2, r0, r5
   29 0000002A EA01 0305       AND              r3, r1, r5
   30 0000002E         
   31 0000002E 4413            ADD              r3, r2, r3
   32 00000030         
   33 00000030 441C            ADD              r4, r4, r3
   34 00000032 42B4            CMP              r4, r6      ;perform comparison
                                                             here in order to i
                                                            nclude carry from p
                                                            revious nibble add 
                                                            
   35 00000034 BFC8 443C       ADDGT            r4, r7
   36 00000038         
   37 00000038         ;shifting of special values
   38 00000038         ;note that shifting is not done during operation (using 
                       barrel shifter) because the shifted value is not persist
                       ed
   39 00000038 EA4F 1505       LSL              r5, #4
   40 0000003C EA4F 1606       LSL              r6, #4
   41 00000040 EA4F 1707       LSL              r7, #4
   42 00000044         
   43 00000044         ;determine if we need to pursue adding nibbles
   44 00000044 F1B5 6F70       CMP              r5, #0x0f000000



ARM Macro Assembler    Page 2 


   45 00000048 DBED            BLT              next
   46 0000004A         
   47 0000004A         
   48 0000004A         
   49 0000004A 4770            BX               LR
   50 0000004C         
   51 0000004C                 END
Command Line: --debug --xref --cpu=Cortex-M3 --apcs=interwork --depend=bcdadd.d
 -obcdadd.o -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\ST\STM32F10x --predef
ine="__EVAL SETA 1" --list=bcdadd.lst bcdadd.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

PROGRAM 00000000

Symbol: PROGRAM
   Definitions
      At line 2 in file bcdadd.s
   Uses
      None
Comment: PROGRAM unused
add 0000000E

Symbol: add
   Definitions
      At line 17 in file bcdadd.s
   Uses
      At line 11 in file bcdadd.s
Comment: add used once
bcdadd 00000000

Symbol: bcdadd
   Definitions
      At line 7 in file bcdadd.s
   Uses
      At line 4 in file bcdadd.s
Comment: bcdadd used once
next 00000026

Symbol: next
   Definitions
      At line 27 in file bcdadd.s
   Uses
      At line 45 in file bcdadd.s
Comment: next used once
stop 0000000C

Symbol: stop
   Definitions
      At line 14 in file bcdadd.s
   Uses
      At line 14 in file bcdadd.s
Comment: stop used once
5 symbols
329 symbols in table
